# üñ•Ô∏è –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö –¥–ª—è –∑–∞–ø—É—Å–∫–∞ `for_klaster.py` –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ.

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª         | –û–ø–∏—Å–∞–Ω–∏–µ                                                    |
|--------------|-------------------------------------------------------------|
| `Dockerfile` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker –æ–±—Ä–∞–∑–∞ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º                     |
| `run.sh`     | SLURM batch —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞                 |
| `run_exp.md` | **–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É (–ß–ò–¢–ê–¢–¨ –í –ü–ï–†–í–£–Æ –û–ß–ï–†–ï–î–¨!)** |

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

| –§–∞–π–ª                        | –û–ø–∏—Å–∞–Ω–∏–µ                                  | –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                              |
|-----------------------------|-------------------------------------------|-----------------------------------------------|
| `build_and_push.sh`         | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞ | `./build_and_push.sh v1`                      |
| `test_docker_local.sh`      | –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞         | `./test_docker_local.sh`                      |
| `cluster_config.example.sh` | –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏                       | –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ `cluster_config.sh` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp cluster_config.example.sh cluster_config.sh

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ cluster_config.sh, —É–∫–∞–∂–∏—Ç–µ:
# - –í–∞—à Docker Hub username
# - –í–∞—à username –Ω–∞ SLURM
nano cluster_config.sh
```

### 2. –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–±–æ—Ä–∫—É –ª–æ–∫–∞–ª—å–Ω–æ
./build_and_push.sh v1

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ
./test_docker_local.sh
```

### 3. –ó–∞–ø—É—Å–∫ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ

–°–ª–µ–¥—É–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ **`run_exp.md`** - —Ç–∞–º –æ–ø–∏—Å–∞–Ω—ã –≤—Å–µ —à–∞–≥–∏:
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ enroot
- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ slurm-master
- –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ì–ª–∞–≤–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

**`run_exp.md`** - –ø–æ–ª–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å:
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π
- –ü–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –†–∞–∑–¥–µ–ª–æ–º –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º
- –®–ø–∞—Ä–≥–∞–ª–∫–æ–π –ø–æ SLURM –∫–æ–º–∞–Ω–¥–∞–º

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `for_klaster.py`

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
1. –û–±—É—á–µ–Ω–∏–µ 2 PABBO –º–æ–¥–µ–ª–µ–π (small –∏ large)
2. –û—Ü–µ–Ω–∫—É –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ LDA —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –Ω–∞ 4 –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö:
   - GA (–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º)
   - ES (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è)
   - PABBO_Small (—Å –º–∞–ª–µ–Ω—å–∫–∏–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–º)
   - PABBO_Large (—Å –±–æ–ª—å—à–∏–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–º)
4. –ê–≥—Ä–µ–≥–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π

---

##  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã SLURM (run.sh)

–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `run.sh`:

```bash
--nodes=1              # 1 –Ω–æ–¥–∞
--cpus-per-task=128    # 128 CPU (–º–∞–∫—Å–∏–º—É–º)
--gpus=0               # –ë–µ–∑ GPU (CPU-only)
--time=24:00:00        # –ú–∞–∫—Å–∏–º—É–º 24 —á–∞—Å–∞
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å - —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `run.sh` –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker –æ–±—Ä–∞–∑–∞

```
/app/
‚îú‚îÄ‚îÄ for_klaster.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ pabbo_method/           # PABBO –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îú‚îÄ‚îÄ lda_hyperopt/           # LDA –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ data/                   # –î–∞—Ç–∞—Å–µ—Ç—ã (–≤–∫–ª—é—á–µ–Ω—ã –≤ –æ–±—Ä–∞–∑)
‚îú‚îÄ‚îÄ lda_pipeline_results/   # –ú–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ slurm-master
‚îî‚îÄ‚îÄ ...
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/app/lda_pipeline_results/`, –∫–æ—Ç–æ—Ä–∞—è –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ `/scratch/$USER/lda_results/`.

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

–ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] `data/` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ `.npz` —Ñ–∞–π–ª—ã
- [ ] `requirements.txt` –∞–∫—Ç—É–∞–ª–µ–Ω –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- [ ] –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ (`./test_docker_local.sh`)
- [ ] –í `cluster_config.sh` —É–∫–∞–∑–∞–Ω—ã –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
- [ ] Docker –æ–±—Ä–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–±—Ä–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Docker Hub

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ `/scratch/$USER/lda_results/` –±—É–¥–µ—Ç:

```
run_cluster_4core_YYYYMMDD_HHMMSS/
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ pipeline_main.log           # –ì–ª–∞–≤–Ω—ã–π –ª–æ–≥
‚îÇ   ‚îî‚îÄ‚îÄ pipeline_metrics.json        # –ú–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ experiments/                     # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –¥–∞—Ç–∞—Å–µ—Ç–∞–º –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º
‚îú‚îÄ‚îÄ aggregated_results/              # –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ all_results.csv
‚îÇ   ‚îú‚îÄ‚îÄ statistics.json
‚îÇ   ‚îî‚îÄ‚îÄ *.png                        # –ì—Ä–∞—Ñ–∏–∫–∏
‚îî‚îÄ‚îÄ all_results.json
```

---

## –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

1. **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**: –ß–∏—Ç–∞–π—Ç–µ `run_exp.md`
2. **–ü—Ä–æ–±–ª–µ–º—ã —Å Docker**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./test_docker_local.sh`
3. **–ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `slurm-*.out` –∏ `slurm-*.err`
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞—Å—Ç–µ—Ä–∞**: http://10.36.60.3:3000/

---

**–£–¥–∞—á–∏ —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏! üéØ**